@{
    ViewData["CategoryVisibility"] = (ViewData["CategoryVisibility"] == null) ? "none" : ViewData["CategoryVisibility"];
    
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no"  />
    <title>@ViewData["Title"] - CAPSTONE_TEAM01_2024</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/CAPSTONE_TEAM01_2024.styles.css" asp-append-version="true" />
</head>
<body>
    <header>
        <!-- Main navbar -->
        <nav class="navbar navbar-expand-sm navbar-light border-bottom box-shadow" id="Login_Top_Nav" style="height:8vh;">
            <!-- Logo and name / Left navbar -->
            <div class="container-fluid">
                <img src="~/Resources/Img/logoVL.png" class="brand-image elevation-3" style="width: 50px; height: auto;>
                <a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index"><b class="m-2 text-white text-center">QUẢN LÝ CÔNG TÁC<br>CỐ VẤN HỌC TẬP</b></a>

                <!-- Space coz im clueless -->
                <div class="navbar-collapse collapse d-sm-inline-flex justify-content-center">
                </div>

                <!-- Right navbar links -->
                <ul class="navbar-nav ml-auto">
                    <li class="user-panel mt-1 pb-1 mb-1 d-flex">
                        <div class="image">
                            <img src="~/Resources/Img/user2-160x160.jpg" class="rounded-circle elevation-2" alt="User Image" style="width: 50px; height: auto;">
                        </div>
                        <div class="info">
                            <a class="text-white d-block" href="#">@User.Identity!.Name</a>
                            <form class="form-inline" asp-action="logout" asp-controller="users">
                                <button type="submit" 
                                        class="nav-link btn btn-link btn-dark text-white float-right"
                                        style="height:50%;"
                                        id="logoutButton">
                                Logout
                            </button>
                        </form>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    <!--Content of pages-->
    <div class="container-fluid d-flex flex-collumn" id="Content_Display">
            <!--Side Navbar-->
        <div class ="p-1 box-shadow" id="SideNav">
            <ul class="navbar-nav">
                <li class="nav-item text-start m-1">
                    <a class="row d-flex nav-link text-dark justify-content-center align-items-center"
                       asp-area="" asp-controller="Home" asp-action="HomePage"
                       style="text-decoration:none">
                        <div class="col-2">
                            <img src="~/Resources/Img/Icon3.png"
                                 style="width:40px; height:auto;">
                        </div>
                        <div class="col-8 fs-6">
                            TRANG CHỦ
                        </div>
                    </a>
                </li>
                <li class="nav-item text-start m-1">
                    <a class="row d-flex nav-link text-dark justify-content-center align-items-center"
                       asp-area="" asp-controller="ProfileManager" asp-action="ProfileManager"
                       style="text-decoration:none">
                        <div class="col-2">
                            <img src="~/Resources/Img/Icon2.png"
                                 style="width:40px; height:auto;">
                        </div>
                        <div class="col-8 fs-6">
                            QUẢN LÝ TÀI KHOẢN
                        </div>
                    </a>
                </li>
                <li class="nav-item text-start m-1">
                    <div class="row d-flex nav-link text-dark justify-content-center align-items-center"
                         style="text-decoration:none">
                        <div class="col-2">
                            <img src="~/Resources/Img/Icon1.png"
                                 style="width:40px; height:auto;">
                        </div>
                        <div class="col-8 fs-6 btn menu-btn fw-bold text-dark text-start">                                                     
                            DANH MỤC
                        </div>
                        <!-- Show More Menu -->
                        <div id="Category_Content"
                             class="menu-content ms-auto"
                             style="display:none;width:90%">
                            <a class="row d-flex nav-link text-dark m-1 justify-content-center align-items-center m-0 p-1"
                               asp-area="" asp-controller="Categories" asp-action="SchoolYear"
                               style="text-decoration:none;">
                                <div class="col-2">
                                    <img src="~/Resources/Img/Icon5.png"
                                         style="width:30px; height:auto;">
                                </div>
                                <div class="col-10">
                                    Năm Học
                                </div>
                            </a>
                            <a class="row d-flex nav-link text-dark m-1 justify-content-center align-items-center m-0 p-1"
                               asp-area="" asp-controller="Categories" asp-action="SemesterPlan"
                               style="text-decoration:none">
                                <div class="col-2">
                                    <img src="~/Resources/Img/Icon7.jpg"
                                         style="width:30px; height:auto;">
                                </div>
                                <div class="col-10">
                                    Kế Hoạch Học Kỳ
                                </div>
                            </a>
                            <a class="row d-flex nav-link text-dark m-1 justify-content-center align-items-center m-0 p-1"
                               asp-area="" asp-controller="Categories" asp-action="EndSemesterReport"
                               style="text-decoration:none">
                                <div class="col-2">
                                    <img src="~/Resources/Img/Icon6.jpg"
                                         style="width:30px; height:auto;">
                                </div>
                                <div class="col-10">
                                    Báo Cáo Cuối Kì
                                </div>
                            </a>
                        </div>
                    </div>
                </li>
                <li class="nav-item text-start m-1">
                    <a class="row d-flex nav-link text-dark justify-content-center align-items-center"
                       asp-area="" asp-controller="Statistics" asp-action="ShowStatistics"
                       style="text-decoration:none">
                        <div class="col-2">
                            <img src="~/Resources/Img/Icon4.png"
                                 style="width:40px; height:auto;">
                        </div>
                        <div class="col-8 fs-6">
                            THỐNG KÊ
                        </div>
                    </a>
                </li>
            </ul>
        </div>
            <!--Content of page-->
            <div id="Content_Panel">
                <main role="main">
                    @RenderBody()
                </main>
            </div>
    </div>
       
    <!--Footer-->
    <footer class="border-top text-muted">
        <div class="container-fluid" id="Main_Footer">
            <div style="float:left; display:inline;">
                <b style="color:#d72235;">&copy; 2024 - Đại học Văn Lang<br></b>
                <b>Khoa Công Nghệ Thông Tin</b>
            </div>
        </div>
    </footer>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script>
        // var subMenus = document.querySelectorAll('div#Category_Content a');

        // for (let subMenu of subMenus) {
        //     subMenu.addEventListener('click', (event) => {
        //         event.preventDefault();
        //         console.log(event.target);
        //     });
        // }

        document.addEventListener("DOMContentLoaded", function () {
            // Get the current URL path
            var path = window.location.pathname;
            var page = path.split("/").pop();

            // Define a mapping between pages and nav item IDs
            var pageMap = {
                "index.html": "home",
                "account.html": "account",
                "category.html": "category",
                "statistics.html": "statistics"
            };

            // Get the corresponding nav item ID
            var navItemId = pageMap[page] || "home"; // Default to "home" if page not found

            // Add the "selected" class to the corresponding nav item
            // document.getElementById(navItemId).classList.add("selected");
        });



    </script>
    <script>
        //persistent drop down
        document.addEventListener("DOMContentLoaded", function () {
            const categoryContent = document.getElementById("Category_Content");
            const savedState = sessionStorage.getItem("CategoryVisibility");

            if (savedState) {
                categoryContent.style.display = savedState;
            }

            // Remove the hidden class after setting the display state
            categoryContent.classList.remove("hidden");

            document.querySelector(".menu-btn").addEventListener("click", function () {
                if (categoryContent.style.display === "none" || categoryContent.style.display === "") {
                    categoryContent.style.display = "block";
                    sessionStorage.setItem("CategoryVisibility", "block");
                } else {
                    categoryContent.style.display = "none";
                    sessionStorage.setItem("CategoryVisibility", "none");
                }
            });
        });

        //toggle visibility for category dropdown
        function toggleCategory(x) {

            if (x.style.display == "none") {
                x.style.display = "block";
        @ViewData["CategoryVisibility"] = "block";
            }
            else {
                x.style.display = "none";
        @ViewData["CategoryVisibility"] = "block";
            }
        }
        //clear session data when logout
        document.addEventListener("DOMContentLoaded", function () {
            const logoutButton = document.getElementById("logoutButton");

            if (logoutButton) {
                logoutButton.addEventListener("click", function () {
                    sessionStorage.clear();
                });
            }
        });

    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
